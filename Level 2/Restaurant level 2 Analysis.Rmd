---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
library(knitr)
opts_chunk$set(fig.path = "figures/", fig.ext = "png")  # Save all plots to 'figures/' folder
```

```{r}
Dataset_bA <- read.csv("C:/Users/Mideh/Downloads/Dataset_bA.csv")

```

```{r}
# checking the structure and the first 7 rows of the dataset and renaming the dataset
head(Dataset_bA,7)
structure(Dataset_bA)
D_A <- Dataset_bA

```

```{r}
# checking to see for blanks in the entire dataset and in the Cuisines column
sum(D_A == "", na.rm = TRUE)  
sum(D_A$Cuisines == "")  

``` 


```{r}
#cleaning the dataset by removing the NA
D_A[D_A == ""] <- NA               
D_A_clean <- na.omit(D_A)

```



```{r}
# loading necesaary libraries
library(dplyr)
library(tidyr)

```

```{r}
#Split the 'Cuisines' column to handle multiple cuisines per restaurant
D_A_cuisines <- D_A_clean %>%
  separate_rows(Cuisines, sep = ",") %>%
  mutate(Cuisines = trimws(Cuisines))  # Remove extra spaces
print(D_A_cuisines)

```

### TASK 1: RESTAURANT RATINGS
```{r}
library(ggplot2)
# Step 1 Analyze the Distribution of Aggregate Ratings

# Create a histogram of the aggregate ratings
ggplot(D_A_cuisines, aes(x = Aggregate.rating)) +
  geom_histogram(binwidth = 0.5, fill = "skyblue", color = "black") +
  labs(title = "Distribution of Aggregate Ratings", x = "Aggregate Rating", y = "Count of Restaurants") +
  theme_minimal()

```


```{r}
# Step 1.2: Identify the most common rating range

rating_range <- D_A_cuisines %>%
  group_by(Aggregate.rating)%>%
  summarise(count = n()) %>%
  arrange(desc(count)) 
most_common_rating_range <- rating_range[1,]
print(most_common_rating_range)
# Step 2: Calculate the Average Number of Votes Received by Restaurants

# Calculate the average number of votes
Average_votes <- D_A_cuisines %>%
  summarise(average_votes = mean(Votes, na.rm = TRUE))
```

### TASK 2: CUISINE COMBINATION
```{r}
# Step 1: Identify the Most Common Combinations of Cuisines
# Count how many times each cuisine combination appears
Common_cuisines_combination <- D_A_cuisines %>%
  group_by(Cuisines)%>%
  summarise(count = n())%>%
  arrange(desc(count)) 
print(Common_cuisines_combination)
```



### TASK 3: GEOGRAPHIC ANALYSIS
```{r}
library(sf)
# Step 2: Determine if Certain Cuisine Combinations Tend to Have Higher Ratings
# Calculate the average aggregate rating for each cuisine combination
cuisines_combinations_ratings <- D_A_cuisines %>%
  group_by(Cuisines)%>%
  summarise(Avg_rating = mean(Aggregate.rating, count = n()))%>%
  arrange(desc(Avg_rating))

# location of restaurants on a map
# Convert to sf object using longitude and latitude
restaurants_sf <- st_as_sf(D_A_cuisines, coords = c("Longitude", "Latitude"), crs = 4326)

# Create the plot
ggplot() +
  geom_sf(data = restaurants_sf) +
  theme_minimal() +
  labs(title = "Restaurant Locations", x = "Longitude", y = "Latitude")

```


### TASK 4: RESTAURANT CHAINS
```{r}
# Step 1: Identify restaurant chains (restaurants with multiple locations)
restaurant_chains <- D_A_cuisines %>%
  group_by(Restaurant.Name) %>%
  summarise(
    location_count = n_distinct(Restaurant.ID),  # Count distinct Restaurant IDs
    avg_rating = mean(Aggregate.rating),  # Calculate average rating
    total_votes = sum(Votes)  # Sum of votes (popularity)
  ) %>%
  filter(location_count > 1)  # Keep only restaurant chains (more than 1 location)


# Step 2: View the result
print(restaurant_chains)
```

```{r}
# You can sort by average rating or total votes to find the most popular chains
top_rated_chains <- restaurant_chains %>%
  arrange(desc(avg_rating))  # Sort by average rating

print(top_rated_chains)

most_popular_chains <- restaurant_chains %>%
  arrange(desc(total_votes))  # Sort by total votes

print(most_popular_chains)
```