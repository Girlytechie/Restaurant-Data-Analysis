---
title: "Restaurant level 1 Analysis"
author: "Oguntoyinbo Taiwo"
date: "`r Sys.Date()`"
output: word_document
---

DATA EXPLORATION
  importing dataset and viewing the dataset
  
```{r}
Dataset_bA <- read.csv("C:/Users/Mideh/Downloads/Dataset_bA.csv")

```


```{r}
# checking the structure and the first 7 rows of the dataset and renaming the dataset
head(Dataset_bA,7)
structure(Dataset_bA)
D_A <- Dataset_bA
```

```{r}
# checking to see for blanks in the entire dataset and in the Cuisines column
sum(D_A == "", na.rm = TRUE)  
sum(D_A$Cuisines == "")  

``` 
There were 9 blanks in the dataset which were found in the Cuisines column




```{r}
#cleaning the dataset by removing the NA
D_A[D_A == ""] <- NA               
D_A_clean <- na.omit(D_A)
```



```{r}
loading necesaary libraries
library(dplyr)
library(tidyr)

```

Task 1: TOP CUISINES AND THEIR PERCENTAGES
```{r}
#Split the 'Cuisines' column to handle multiple cuisines per restaurant
D_A_cuisines <- D_A_clean %>%
  separate_rows(Cuisines, sep = ",") %>%
  mutate(Cuisines = trimws(Cuisines))  # Remove extra spaces
print(D_A_cuisines)

```





```{r}
# Count occurrences of each cuisine
top_cuisines <- D_A_cuisines %>%
  group_by(Cuisines) %>% 
  summarise(restaurant_count = n_distinct(Restaurant.ID)) %>%  # Count distinct Restaurant_ID
  arrange(desc(restaurant_count)) %>%
  top_n(3, restaurant_count)

# Calculate percentage of restaurants serving each top cuisine
total_restaurants <- nrow(D_A_clean)
top_cuisines <- top_cuisines %>%
  mutate(percentage = (restaurant_count / total_restaurants) * 100)

# View results
print(top_cuisines)
```


Task 2: CITY ANALYSIS
```{r}
# Step 1: Identify the City with the Highest Number of Restaurants

city_restaurant_count <- D_A_cuisines %>%
  group_by(City) %>%
  summarise(restaurant_count = n_distinct(Restaurant.ID)) %>%  # Count distinct Restaurant_ID
  arrange(desc(restaurant_count))

# Display the city with the highest number of restaurants
city_with_most_restaurants <- city_restaurant_count[1, ]
print(city_with_most_restaurants)


```

```{r}
# Step 2: Calculate the Average Rating for Restaurants in Each City

city_avg_rating <- D_A_cuisines %>%
  group_by(City) %>%
  summarise(average_rating = mean(Aggregate.rating, na.rm = TRUE)) %>%
  arrange(desc(average_rating))

# Display the average rating for each city
print(city_avg_rating)
```

```{r}
# Step 3: Determine the City with the Highest Average Rating

city_with_highest_avg_rating <- city_avg_rating[1, ]
print(city_with_highest_avg_rating)

```

Task 3: RANGE DISTRIBUTION
```{r}
# Step 1: Create a Bar Chart of Price Range Distribution
# Assuming the 'Price range' column is already present in your dataset

ggplot(D_A_cuisines, aes(x = Price.range)) +
  geom_bar(fill = "yellow") +
  labs(title = "Price Range Distribution", x = "Price Range", y = "Number of Restaurants") +
  theme_minimal()
```

```{r}
# Step 2: Calculate the Percentage of Restaurants in Each Price Range Category
price_range_distribution <- D_A_cuisines %>%
  group_by(Price.range) %>%
  summarise(count = n()) %>%
  mutate(percentage = (count / sum(count)) * 100)

# Print the price range distribution with percentages
print(price_range_distribution)
```

Task 4: ONLINE DELIVERY
```{r}
# Step 1: Determine the Percentage of Restaurants that Offer Online Delivery

# Calculate the percentage of restaurants that offer online delivery
online_delivery_percentage <- D_A_cuisines %>%
  group_by(Has.Online.delivery) %>%
  summarise(count = n()) %>%
  mutate(percentage = (count / sum(count)) * 100)

# Print the percentage of restaurants that offer online delivery
print(online_delivery_percentage)
```











